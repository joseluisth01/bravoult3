<?php
if (function_exists('acf_add_local_field_group')) :

    acf_add_local_field_group(array(
        'key' => 'group_6295w4efgewf',
        'title' => 'Texto e imagen doble',
        'fields' => array(
            array(
                'key' => 'field_6ervgsrv',
                'label' => 'Titulo',
                'name' => 'titulo_texto_e_imagendoble',
                'aria-label' => '',
                'type' => 'text',
                'instructions' => '',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
                'default_value' => '',
                'placeholder' => '',
                'prepend' => '',
                'append' => '',
                'maxlength' => '',
            ),
            array(
                'key' => 'field_6erfgvsdfv',
                'label' => 'Texto',
                'name' => 'texto_bloquedoble',
                'aria-label' => '',
                'type' => 'wysiwyg',
                'instructions' => '',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
                'default_value' => '',
                'tabs' => 'all',
                'toolbar' => 'full',
                'media_upload' => 1,
                'delay' => 0,
            ),
            array(
                'key' => 'field_62950eerdsvgregdv',
                'label' => 'Imagen Principal',
                'name' => 'imagen_bloquedoble',
                'aria-label' => '',
                'type' => 'image',
                'instructions' => '',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
                'return_format' => 'array',
                'library' => 'all',
                'min_width' => '',
                'min_height' => '',
                'min_size' => '',
                'max_width' => '',
                'max_height' => '',
                'max_size' => '',
                'mime_types' => '',
                'preview_size' => 'medium',
            ),
            array(
                'key' => 'field_62950e34secergsdverf',
                'label' => 'Imagen Secundaria',
                'name' => 'imagen_secundaria_bloquedoble',
                'aria-label' => '',
                'type' => 'image',
                'instructions' => '',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
                'return_format' => 'array',
                'library' => 'all',
                'min_width' => '',
                'min_height' => '',
                'min_size' => '',
                'max_width' => '',
                'max_height' => '',
                'max_size' => '',
                'mime_types' => '',
                'preview_size' => 'medium',
            ),
            array(
                'key' => 'field_imagen_tergsbvdfvbg',
                'label' => 'Imagen Terciaria',
                'name' => 'imagen_terciaria_bloquedoble',
                'aria-label' => '',
                'type' => 'image',
                'instructions' => '',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
                'return_format' => 'array',
                'library' => 'all',
                'min_width' => '',
                'min_height' => '',
                'min_size' => '',
                'max_width' => '',
                'max_height' => '',
                'max_size' => '',
                'mime_types' => '',
                'preview_size' => 'medium',
            ),
            array(
                'key' => 'field_6295ergvdfgv',
                'label' => 'Invertir',
                'name' => 'invertirdoble',
                'aria-label' => '',
                'type' => 'true_false',
                'instructions' => '',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
                'message' => '',
                'default_value' => 0,
                'ui' => 0,
                'ui_on_text' => '',
                'ui_off_text' => '',
            ),
            array(
                'key' => 'field_629qergrfgv',
                'label' => 'Enlace Principal',
                'name' => 'enlace_texto_imagendoble',
                'aria-label' => '',
                'type' => 'link',
                'instructions' => '',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
                'return_format' => 'array',
            ),
            array(
                'key' => 'field_6296t4regerv',
                'label' => 'Enlace Secundario',
                'name' => 'enlace_texto_imagen_secundariodoble',
                'aria-label' => '',
                'type' => 'link',
                'instructions' => '',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
                'return_format' => 'array',
            ),
            array(
                'key' => 'field_ergrfdvg',
                'label' => 'Enlace Adicional',
                'name' => 'enlace_texto_imagen_adicionaldoble',
                'aria-label' => '',
                'type' => 'link',
                'instructions' => '',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
                'return_format' => 'array',
            ),
            array(
                'key' => 'field_fondo_titulodobleerg',
                'label' => 'Color de fondo del título',
                'name' => 'fondo_titulodoble',
                'type' => 'color_picker',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
            ),
            array(
                'key' => 'field_color_titulodoble4erge',
                'label' => 'Color del texto del título',
                'name' => 'color_titulodoble',
                'type' => 'color_picker',
                'required' => 0,
                'conditional_logic' => 0,
                'wrapper' => array(
                    'width' => '',
                    'class' => '',
                    'id' => '',
                ),
            ),
        ),
        'location' => array(
            array(
                array(
                    'param' => 'block',
                    'operator' => '==',
                    'value' => 'acf/texto-y-fotodoble',
                ),
            ),
        ),
        'menu_order' => 0,
        'position' => 'normal',
        'style' => 'default',
        'label_placement' => 'top',
        'instruction_placement' => 'label',
        'hide_on_screen' => '',
        'active' => true,
        'description' => '',
        'show_in_rest' => 0,
    ));

endif;

acf_register_block_type([
    'name'        => 'Texto y foto doble',
    'title'        => __('Texto y foto doble', 'tictac'),
    'description'    => __('Texto y foto doble', 'tictac'),
    'render_callback'  => 'texto_fotodoble',
    'mode'        => 'preview',
    'icon'        => 'image-filter',
    'keywords'      => ['texto', 'doble', 'foto'],
]);

function texto_fotodoble($block)
{
    $texto_bloque = get_field("texto_bloquedoble");
    $imagen_bloque = get_field("imagen_bloquedoble");
    $imagen_secundaria = get_field("imagen_secundaria_bloquedoble");
    $imagen_terciaria = get_field("imagen_terciaria_bloquedoble");
    $invertir = get_field("invertirdoble");
    $titulo_texto_e_imagen = get_field("titulo_texto_e_imagendoble");
    $enlace_texto_imagen = get_field("enlace_texto_imagendoble");
    $enlace_texto_imagen_secundario = get_field("enlace_texto_imagen_secundariodoble");
    $enlace_texto_imagen_adicional = get_field("enlace_texto_imagen_adicionaldoble");
    $fondo_titulo = get_field("fondo_titulodoble");
    $color_titulo = get_field("color_titulodoble");
    
    if ($invertir) {
        $invertir = "inv";
    } else {
        $invertir = "";
    }
?>
    <link rel="stylesheet" href="<?php echo get_stylesheet_directory_uri(); ?>/assets/functions/blocks/texto_imagendoble/texto_imagendoble.min.css">
    <div class="<?php if (isset($block['className'])) {
                    echo $block['className'];
                } ?> texto_imagen2 <?= $invertir; ?>">
        <div class="container">
            <div class="texto">
                <?php if ($titulo_texto_e_imagen) { ?>
                    <div class="titulo" style="<?php 
                        if ($fondo_titulo) { echo 'background-color:' . $fondo_titulo . ';'; }
                    ?>">
                        <h2 style="<?php 
                            if ($color_titulo) { echo 'color:' . $color_titulo . ';'; }
                        ?>">
                            <?= $titulo_texto_e_imagen; ?>
                        </h2>
                    </div>
                <?php } ?>
                <div class="contenido-texto">
                    <?= $texto_bloque; ?>
                </div>
                <div class="enlaces">
                    <?php if ($enlace_texto_imagen) { ?>
                        <div class="enlace enlace-principal">
                            <a class="btn custom black" href="<?= $enlace_texto_imagen['url']; ?>"><?= $enlace_texto_imagen['title']; ?></a>
                        </div>
                    <?php } ?>
                    <?php if ($enlace_texto_imagen_secundario) { ?>
                        <div class="enlace enlace-secundario">
                            <a class="btn custom black" href="<?= $enlace_texto_imagen_secundario['url']; ?>"><?= $enlace_texto_imagen_secundario['title']; ?></a>
                        </div>
                    <?php } ?>
                    <?php if ($enlace_texto_imagen_adicional) { ?>
                        <div class="enlace enlace-adicional">
                            <a class="btn custom black" href="<?= $enlace_texto_imagen_adicional['url']; ?>"><?= $enlace_texto_imagen_adicional['title']; ?></a>
                        </div>
                    <?php } ?>
                </div>
            </div>
            <div class="imagenes-container">
                <div class="imagen imagen-principal">
                    <?php if ($imagen_bloque) : ?>
                        <img src="<?php echo esc_url($imagen_bloque['url']); ?>" alt="<?php echo esc_attr($imagen_bloque['alt']); ?>" />
                    <?php endif; ?>
                </div>
                <?php if ($imagen_secundaria || $imagen_terciaria) : ?>
                <div class="imagenes-adicionales">
                    <?php if ($imagen_secundaria) : ?>
                        <div class="imagen imagen-secundaria">
                            <img src="<?php echo esc_url($imagen_secundaria['url']); ?>" alt="<?php echo esc_attr($imagen_secundaria['alt']); ?>" />
                        </div>
                    <?php endif; ?>
                    <?php if ($imagen_terciaria) : ?>
                        <div class="imagen imagen-terciaria">
                            <img src="<?php echo esc_url($imagen_terciaria['url']); ?>" alt="<?php echo esc_attr($imagen_terciaria['alt']); ?>" />
                        </div>
                    <?php endif; ?>
                </div>
                <?php endif; ?>
            </div>
        </div>
    </div>
<?php
}